# å­—ç¬¦ä¸²

## ç å…ƒ

æœ€å°å•ä½

ä¸€ä¸ªæ–‡å­—æ˜¯ä¸€ä¸ªç ç‚¹

æ™®é€šæ–‡å­—æ˜¯ä¸€ä¸ªç å…ƒ

ç‰¹æ®Šæ–‡å­—æ˜¯ä¸¤ä¸ªç å…ƒ

å› ä¸ºç‰¹æ®Šæ–‡å­—ä¼šè¶…è¿‡16ä½ï¼ˆutf-16ï¼‰ï¼Œä»–å°±ä¼šå ç”¨ä¸¤ä¸ªç å…ƒ



ä¸€èˆ¬çš„slice length éƒ½æ˜¯åŸºäºç å…ƒç´¢å¼•çš„

## ç ç‚¹

ç ç‚¹æ˜¯å®è§‚çš„ä¸€ä¸ªå­—ä½“å•ä½

str.codePointAt(index) 

æ ¹æ®ç´¢å¼•è·å–ç ç‚¹  > 0xffff å°±æ˜¯å¤§äº16ä½

String.fromPointCode(index)

æ ¹æ®ç ç‚¹è·å–æ–‡å­—



## å®šä¹‰ä¸€ä¸ªå‡†ç¡®æˆªå–slice

åŸºäºç ç‚¹ç´¢å¼•

```javascript
String.prototype.sliceByCodePoint = function (sIdx, eIdx) {
    let result = ""
    let pIdx = 0, // ç ç‚¹ç´¢å¼•
        cIdx = 0, // ç å…ƒç´¢å¼•
        len = this.length // ç å…ƒé•¿åº¦
    while (1) {
        if (pIdx >= eIdx || cIdx >= len) {
            break
        }
        const point = this.codePointAt(cIdx) // ç ç‚¹
        // åˆ°è¾¾èµ·å§‹ç´¢å¼•å¼€å§‹æ”¶é›†
        if (pIdx >= sIdx) {
            result += String.fromCodePoint(point)
        }
        cIdx += point > 0xffff ? 2 : 1
        pIdx++
    }
    return result
}

const str = "1ğŸ˜ŠğŸ˜Š234"
console.log(str.sliceByCodePoint(0, 3)) // "1ğŸ˜Š"

```